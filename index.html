<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>(ì‚¬)í•œêµ­ì£¼ìœ ì†Œí˜‘íšŒ ê²½ê¸°ë„íšŒ ì£¼ìœ ì†Œ ìˆ˜ìµ ë§¤ë‹ˆì € Pro</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons (Standalone) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* ëª¨ë°”ì¼ í„°ì¹˜ ìµœì í™” ë° ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ */
        body { -webkit-tap-highlight-color: transparent; overscroll-behavior-y: none; }
        ::-webkit-scrollbar { width: 0px; background: transparent; }
        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
        
        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 select-none">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // --- ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸ ---
        const Icon = ({ name, size = 24, className = "", strokeWidth = 2 }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (iconRef.current) {
                    lucide.createIcons({
                        root: iconRef.current,
                        name: name,
                        attrs: { width: size, height: size, class: className, "stroke-width": strokeWidth }
                    });
                }
            }, [name, size, className, strokeWidth]);
            return <span ref={iconRef} className="inline-flex items-center justify-center" />;
        };

        // --- ìœ í‹¸ë¦¬í‹° ---
        const formatNumber = (num) => {
            if (num === undefined || num === null || isNaN(num)) return "0";
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        };

        const formatDateShort = (dateStr) => {
            const date = new Date(dateStr);
            return `${date.getMonth() + 1}.${date.getDate()}`;
        };

        const copyToClipboard = (text, onSuccess, onFail) => {
            try {
                const textArea = document.createElement("textarea");
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                if (onSuccess) onSuccess();
            } catch (err) {
                if (onFail) onFail();
            }
        };

        // --- ìƒìˆ˜ ---
        const STATION_IDS = ['s1', 's2', 's3'];
        const INITIAL_INVENTORY_TEMPLATE = {
            gasoline: { amount: 0, avgPrice: 0, color: 'bg-yellow-400', text: 'text-yellow-700', name: 'íœ˜ë°œìœ ' },
            diesel: { amount: 0, avgPrice: 0, color: 'bg-green-500', text: 'text-green-700', name: 'ê²½ìœ ' },
            kerosene: { amount: 0, avgPrice: 0, color: 'bg-red-500', text: 'text-red-700', name: 'ë“±ìœ ' }
        };

        // --- ìŠ¤í† ë¦¬ì§€ í‚¤ ---
        const STORAGE_KEY_TRANSACTIONS = 'gas_station_transactions_v6';
        const STORAGE_KEY_INVENTORY = 'gas_station_inventory_v6';
        const STORAGE_KEY_SETTINGS = 'gas_station_settings_v6';

        // --- ë©”ì¸ ì•± ---
        const GasStationProfitApp = () => {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [currentStationId, setCurrentStationId] = useState('s1');

            // ë°ì´í„° ìƒíƒœ
            const [transactions, setTransactions] = useState(() => {
                try {
                    const saved = localStorage.getItem(STORAGE_KEY_TRANSACTIONS);
                    const parsed = saved ? JSON.parse(saved) : [];
                    return parsed.map(t => t.stationId ? t : { ...t, stationId: 's1' });
                } catch (e) { return []; }
            });

            const [inventoryMap, setInventoryMap] = useState(() => {
                try {
                    const saved = localStorage.getItem(STORAGE_KEY_INVENTORY);
                    let parsed = saved ? JSON.parse(saved) : {};
                    STATION_IDS.forEach(id => {
                        if (!parsed[id]) parsed[id] = JSON.parse(JSON.stringify(INITIAL_INVENTORY_TEMPLATE));
                    });
                    return parsed;
                } catch (e) {
                    return {
                        s1: JSON.parse(JSON.stringify(INITIAL_INVENTORY_TEMPLATE)),
                        s2: JSON.parse(JSON.stringify(INITIAL_INVENTORY_TEMPLATE)),
                        s3: JSON.parse(JSON.stringify(INITIAL_INVENTORY_TEMPLATE))
                    };
                }
            });

            const [appSettings, setAppSettings] = useState(() => {
                try {
                    const saved = localStorage.getItem(STORAGE_KEY_SETTINGS);
                    const parsed = saved ? JSON.parse(saved) : {};
                    const defaults = {
                        alertThreshold: 3000,
                        goals: { s1: 5000000, s2: 5000000, s3: 5000000 },
                        stationNames: { s1: '1í˜¸ì  (ë³¸ì )', s2: '2í˜¸ì  (ì§ì˜)', s3: '3í˜¸ì  (ëŒ€ë¦¬ì )' },
                        safeMode: true
                    };
                    return { ...defaults, ...parsed, goals: { ...defaults.goals, ...(parsed.goals || {}) }, stationNames: { ...defaults.stationNames, ...(parsed.stationNames || {}) } };
                } catch (e) { 
                    return { alertThreshold: 3000, goals: { s1: 5000000, s2: 5000000, s3: 5000000 }, stationNames: { s1: '1í˜¸ì  (ë³¸ì )', s2: '2í˜¸ì  (ì§ì˜)', s3: '3í˜¸ì  (ëŒ€ë¦¬ì )' }, safeMode: true }; 
                }
            });

            // UI ìƒíƒœ
            const [editingTransaction, setEditingTransaction] = useState(null);
            const [confirmModal, setConfirmModal] = useState({ isOpen: false, type: null, data: null, message: '' });
            const [helpModalOpen, setHelpModalOpen] = useState(false);
            const [stationSelectorOpen, setStationSelectorOpen] = useState(false);
            const [toast, setToast] = useState({ show: false, message: '' });

            // Helpers
            const getStationName = (id) => appSettings.stationNames[id] || `ì§€ì  ${id}`;
            const currentStationName = getStationName(currentStationId);
            const currentInventory = inventoryMap[currentStationId];
            const currentGoal = appSettings.goals[currentStationId] || 5000000;

            // ìœ ì¢…ë³„ ìƒ‰ìƒ ìŠ¤íƒ€ì¼ í—¬í¼
            const getFuelStyle = (fuelType) => {
                switch(fuelType) {
                    case 'gasoline': return 'bg-yellow-100 text-yellow-800 border-yellow-200';
                    case 'diesel': return 'bg-green-100 text-green-800 border-green-200';
                    case 'kerosene': return 'bg-red-100 text-red-800 border-red-200';
                    default: return 'bg-gray-100 text-gray-800';
                }
            };

            // ì €ì¥
            useEffect(() => { localStorage.setItem(STORAGE_KEY_TRANSACTIONS, JSON.stringify(transactions)); }, [transactions]);
            useEffect(() => { localStorage.setItem(STORAGE_KEY_INVENTORY, JSON.stringify(inventoryMap)); }, [inventoryMap]);
            useEffect(() => { localStorage.setItem(STORAGE_KEY_SETTINGS, JSON.stringify(appSettings)); }, [appSettings]);

            // í† ìŠ¤íŠ¸ íƒ€ì´ë¨¸
            useEffect(() => {
                if (toast.show) {
                    const timer = setTimeout(() => setToast({ ...toast, show: false }), 3000);
                    return () => clearTimeout(timer);
                }
            }, [toast.show]);

            const showToast = (message) => setToast({ show: true, message });

            // ì…ë ¥ í¼
            const [inputType, setInputType] = useState('sale');
            const [inputDate, setInputDate] = useState(new Date().toISOString().split('T')[0]);
            const [inputFuelType, setInputFuelType] = useState('gasoline');
            const [inputAmount, setInputAmount] = useState('');
            const [inputPrice, setInputPrice] = useState('');

            // ê³„ì‚°
            const stationTransactions = useMemo(() => transactions.filter(t => t.stationId === currentStationId), [transactions, currentStationId]);

            const summary = useMemo(() => {
                let totalRevenue = 0; let totalProfit = 0; let totalSalesVolume = { gasoline: 0, diesel: 0, kerosene: 0 }; let monthlyProfits = {}; 
                stationTransactions.forEach(t => {
                    if (t.type === 'sale') {
                        const transactionTotal = t.total || (t.amount * t.price);
                        totalRevenue += transactionTotal; totalProfit += (t.profit || 0);
                        if (totalSalesVolume[t.fuelType] !== undefined) totalSalesVolume[t.fuelType] += Number(t.amount);
                        monthlyProfits[t.date] = (monthlyProfits[t.date] || 0) + (t.profit || 0);
                    }
                });
                const chartData = Object.keys(monthlyProfits).sort().map(date => ({ date, profit: monthlyProfits[date] })).slice(-7);
                return { totalRevenue, totalProfit, totalSalesVolume, chartData };
            }, [stationTransactions]);

            const achievementRate = useMemo(() => {
                const rate = (summary.totalProfit / currentGoal) * 100;
                return Math.max(0, Math.round(rate));
            }, [summary.totalProfit, currentGoal]);

            const alerts = useMemo(() => {
                const list = [];
                if (currentInventory) {
                    Object.entries(currentInventory).forEach(([key, data]) => {
                        if (data && data.amount > 0 && data.amount < appSettings.alertThreshold) { 
                            list.push({ type: 'warning', msg: `${data.name} ì¬ê³  ë¶€ì¡± (${formatNumber(data.amount)}L)`, fuel: key });
                        }
                    });
                }
                return list;
            }, [currentInventory, appSettings.alertThreshold]);

            // í•¸ë“¤ëŸ¬ë“¤
            const handleStationChange = (id) => { setCurrentStationId(id); setStationSelectorOpen(false); showToast(`${getStationName(id)} ì „í™˜`); };

            const handleFocus = (e) => {
                setTimeout(() => {
                    e.target.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'nearest' });
                }, 400); 
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!inputAmount || !inputPrice) return;
                const amount = Number(inputAmount); const price = Number(inputPrice); const total = amount * price; const uniqueId = Date.now() + Math.random();
                let newTransaction = { id: uniqueId, stationId: currentStationId, type: inputType, date: inputDate, fuelType: inputFuelType, amount, price, total };
                const nextInventory = { ...currentInventory };

                if (inputType === 'purchase') {
                    const currentItem = nextInventory[inputFuelType];
                    const newAmount = currentItem.amount + amount;
                    let newAvgPrice = newAmount > 0 ? Math.round(((currentItem.amount * currentItem.avgPrice) + total) / newAmount) : price;
                    nextInventory[inputFuelType] = { ...currentItem, amount: newAmount, avgPrice: newAvgPrice };
                } else {
                    const currentItem = nextInventory[inputFuelType];
                    if (currentItem.amount < amount) { showToast("ì˜¤ë¥˜: ì¬ê³  ë¶€ì¡±"); return; }
                    const cost = currentItem.avgPrice;
                    const profit = (price - cost) * amount;
                    newTransaction = { ...newTransaction, cost, profit };
                    nextInventory[inputFuelType] = { ...currentItem, amount: currentItem.amount - amount };
                }
                setInventoryMap({ ...inventoryMap, [currentStationId]: nextInventory });
                setTransactions([newTransaction, ...transactions]);
                setInputAmount(''); setInputPrice('');
                showToast("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
            };

            const handleUpdateTransaction = (e) => {
                e.preventDefault();
                if (!editingTransaction) return;
                const { id, type, date, fuelType, amount, price } = editingTransaction;
                const oldTransaction = transactions.find(t => t.id === id);
                if (!oldTransaction) return;

                const newAmount = Number(amount); const newPrice = Number(price); const newTotal = newAmount * newPrice; const amountDiff = newAmount - oldTransaction.amount;
                let newProfit = 0; let cost = oldTransaction.cost || 0;
                if (type === 'sale') newProfit = (newPrice - cost) * newAmount;

                const updatedTransactions = transactions.map(t => t.id === id ? { ...t, date, amount: newAmount, price: newPrice, total: newTotal, profit: newProfit } : t);
                setTransactions(updatedTransactions);

                if (amountDiff !== 0) {
                  const targetStationId = oldTransaction.stationId; const targetInventory = { ...inventoryMap[targetStationId] }; const currentItem = targetInventory[fuelType];
                  let updatedInvAmount = currentItem.amount;
                  if (type === 'purchase') updatedInvAmount += amountDiff; else updatedInvAmount -= amountDiff;
                  targetInventory[fuelType] = { ...currentItem, amount: updatedInvAmount };
                  setInventoryMap({ ...inventoryMap, [targetStationId]: targetInventory });
                }
                setEditingTransaction(null);
                showToast("ìˆ˜ì • ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
            };

            const handleBackup = () => {
                const data = { transactions, inventoryMap, appSettings, version: 'v6', date: new Date().toISOString() };
                const blob = new Blob([JSON.stringify(data)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url; a.download = `ì£¼ìœ ì†Œìˆ˜ìµ_ë°±ì—…_${new Date().toISOString().slice(0,10)}.json`;
                document.body.appendChild(a); a.click(); document.body.removeChild(a);
                showToast("ë°±ì—… íŒŒì¼ ì €ì¥ ì™„ë£Œ");
            };

            const handleRestore = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const data = JSON.parse(event.target.result);
                        if (data.transactions && data.inventoryMap) {
                            if(confirm("í˜„ì¬ ë°ì´í„°ë¥¼ ëª¨ë‘ ë®ì–´ì“°ê³  ë³µêµ¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                                setTransactions(data.transactions); setInventoryMap(data.inventoryMap);
                                if(data.appSettings) setAppSettings(data.appSettings);
                                showToast("ë³µêµ¬ ì™„ë£Œ");
                            }
                        } else { showToast("ì˜ëª»ëœ íŒŒì¼ì…ë‹ˆë‹¤."); }
                    } catch (err) { showToast("íŒŒì¼ ì½ê¸° ì‹¤íŒ¨"); }
                };
                reader.readAsText(file);
                e.target.value = '';
            };

            const requestDelete = (id) => {
                if (appSettings.safeMode) { showToast("ì•ˆì „ ëª¨ë“œ: ì‚­ì œí•˜ë ¤ë©´ ì„¤ì •ì„ ë„ì„¸ìš”."); return; }
                setConfirmModal({ isOpen: true, type: 'delete', data: id, message: 'ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì¬ê³ ëŠ” ë³µêµ¬ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.' });
            };

            const requestClear = () => setConfirmModal({ isOpen: true, type: 'clear', data: null, message: `í˜„ì¬ ì§€ì (${currentStationName})ì˜ ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?` });
            const requestLoadDemo = () => setConfirmModal({ isOpen: true, type: 'demo', data: null, message: `í˜„ì¬ ì§€ì (${currentStationName})ì— ìƒ˜í”Œ ë°ì´í„°ë¥¼ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?` });

            const executeConfirmAction = () => {
                if (confirmModal.type === 'delete') {
                    setTransactions(transactions.filter(t => t.id !== confirmModal.data));
                    showToast("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
                } else if (confirmModal.type === 'clear') {
                    const otherData = transactions.filter(t => t.stationId !== currentStationId);
                    setTransactions(otherData);
                    setInventoryMap({ ...inventoryMap, [currentStationId]: JSON.parse(JSON.stringify(INITIAL_INVENTORY_TEMPLATE)) });
                    showToast("ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
                } else if (confirmModal.type === 'demo') {
                    const today = new Date(); const newTransactions = []; const rand = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min; const baseTime = Date.now();
                    for (let i = 7; i >= 1; i--) {
                        const d = new Date(today); d.setDate(today.getDate() - i); const dateStr = d.toISOString().split('T')[0]; const mul = currentStationId === 's1' ? 1 : 0.8;
                        const gasAmt = Math.round(rand(800, 1200) * mul); const gasPrc = 1730 + rand(-10, 10);
                        newTransactions.push({ id: baseTime - (i * 1000) - 1 - Math.random(), stationId: currentStationId, type: 'sale', date: dateStr, fuelType: 'gasoline', amount: gasAmt, price: gasPrc, cost: 1640, total: gasAmt * gasPrc, profit: (gasPrc - 1640) * gasAmt });
                        const dieAmt = Math.round(rand(1500, 2500) * mul); const diePrc = 1580 + rand(-10, 10);
                        newTransactions.push({ id: baseTime - (i * 1000) - 2 - Math.random(), stationId: currentStationId, type: 'sale', date: dateStr, fuelType: 'diesel', amount: dieAmt, price: diePrc, cost: 1500, total: dieAmt * diePrc, profit: (diePrc - 1500) * dieAmt });
                        const keroAmt = Math.round(rand(100, 300) * mul); const keroPrc = 1400 + rand(-5, 5);
                        newTransactions.push({ id: baseTime - (i * 1000) - 3 - Math.random(), stationId: currentStationId, type: 'sale', date: dateStr, fuelType: 'kerosene', amount: keroAmt, price: keroPrc, cost: 1300, total: keroAmt * keroPrc, profit: (keroPrc - 1300) * keroAmt });
                    }
                    const newInv = JSON.parse(JSON.stringify(INITIAL_INVENTORY_TEMPLATE));
                    newInv.gasoline.amount = 20000; newInv.gasoline.avgPrice = 1640;
                    newInv.diesel.amount = 40000; newInv.diesel.avgPrice = 1500;
                    newInv.kerosene.amount = 10000; newInv.kerosene.avgPrice = 1300;
                    const otherData = transactions.filter(t => t.stationId !== currentStationId);
                    setTransactions([...otherData, ...newTransactions]);
                    setInventoryMap({ ...inventoryMap, [currentStationId]: newInv });
                    showToast("ìƒ˜í”Œ ë°ì´í„° ìƒì„± ì™„ë£Œ");
                }
                setConfirmModal({ ...confirmModal, isOpen: false });
            };

            const handleCopyAllTransactions = () => {
                if (stationTransactions.length === 0) { showToast("ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤."); return; }
                let text = `[â›½ ${currentStationName} ê±°ë˜ ì¼ë³´]\nğŸ“… ì¶œë ¥: ${new Date().toLocaleDateString()}\n\n`;
                const sorted = [...stationTransactions].sort((a, b) => b.id - a.id);
                sorted.forEach(t => {
                    const fuelName = t.fuelType === 'gasoline' ? 'íœ˜ë°œìœ ' : t.fuelType === 'diesel' ? 'ê²½ìœ ' : 'ë“±ìœ ';
                    const typeName = t.type === 'purchase' ? 'ğŸ”µë§¤ì…' : 'ğŸ”´ë§¤ì¶œ';
                    text += `${typeName} | ${t.date} | ${fuelName}\nğŸ“¦ ${formatNumber(t.amount)}L Ã— @${formatNumber(t.price)}\nğŸ’µ ${formatNumber(t.total)}ì›\n-----------------\n`;
                });
                copyToClipboard(text, () => showToast("ì¼ë³´ ë³µì‚¬ ì™„ë£Œ"), () => showToast("ì‹¤íŒ¨"));
            };

            // ì°¨íŠ¸
            const SimpleLineChart = ({ data }) => {
                if (!data || data.length === 0) return <div className="h-32 flex items-center justify-center text-gray-400 text-xs">ë°ì´í„° ì—†ìŒ</div>;
                const minVal = Math.min(...data.map(d => d.profit)); const maxVal = Math.max(...data.map(d => d.profit)); const range = maxVal - minVal || 1;
                const points = data.map((d, i) => { const x = (i / (data.length - 1 || 1)) * 100; const y = 100 - ((d.profit - minVal) / range) * 80 - 10; return `${x},${y}`; }).join(' ');
                return (
                    <div className="w-full h-32 relative mt-2">
                        <svg viewBox="0 0 100 100" className="w-full h-full overflow-visible" preserveAspectRatio="none">
                            <polyline points={points} fill="none" stroke="#2563eb" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
                            {data.map((d, i) => { const x = (i / (data.length - 1 || 1)) * 100; const y = 100 - ((d.profit - minVal) / range) * 80 - 10; return <circle key={i} cx={x} cy={y} r="2" fill="white" stroke="#2563eb" strokeWidth="1.5" />; })}
                        </svg>
                        <div className="flex justify-between mt-1 text-[10px] text-gray-400">{data.map((d, i) => <span key={i}>{formatDateShort(d.date)}</span>)}</div>
                    </div>
                );
            };

            // --- ë Œë”ë§ ---
            return (
                <div className="flex flex-col h-screen max-w-md mx-auto shadow-2xl bg-gray-50 overflow-hidden relative border-x border-gray-200">
                    
                    {/* í—¤ë” */}
                    <header className="relative h-36 z-20 transition-all duration-500">
                        <div className="absolute inset-0 overflow-hidden rounded-b-[2rem] shadow-xl bg-blue-900">
                            <img src="https://images.unsplash.com/photo-1549317661-bd32c8ce0db2?q=80&w=1000&auto=format&fit=crop" className="absolute inset-0 w-full h-full object-cover opacity-60 mix-blend-overlay" />
                            <div className="absolute inset-0 bg-gradient-to-t from-blue-900 via-blue-900/60 to-transparent"></div>
                        </div>
                        <div className="relative z-10 p-5 pt-6 h-full flex flex-col justify-between text-white">
                            <div className="flex justify-between items-start">
                                <div><span className="text-blue-200 text-xs font-bold tracking-wider flex items-center mb-0.5"><Icon name="fuel" size={12} className="mr-1"/> REVENUE MANAGER PRO</span><h1 className="text-xl font-extrabold drop-shadow-md">ì£¼ìœ ì†Œ ìˆ˜ìµ ë§¤ë‹ˆì €</h1></div>
                                <button onClick={()=>setHelpModalOpen(true)} className="bg-white/10 px-3 py-1.5 rounded-full backdrop-blur-md hover:bg-white/20 text-xs font-bold transition-colors">ë„ì›€</button>
                            </div>
                            <div className="relative">
                                <button onClick={()=>setStationSelectorOpen(!stationSelectorOpen)} className="w-full flex items-center justify-between bg-white/10 backdrop-blur-md border border-white/20 p-2.5 rounded-xl hover:bg-white/20 active:scale-95 transition-all">
                                    <div className="flex items-center"><div className="bg-blue-500 p-1 rounded-lg mr-2.5 shadow-lg"><Icon name="map-pin" size={16} className="text-white"/></div><div className="text-left"><p className="text-[10px] text-blue-200 font-medium leading-none mb-0.5">CURRENT STATION</p><span className="text-base font-bold leading-none">{currentStationName}</span></div></div>
                                    <Icon name="chevron-down" size={18} className={`text-blue-200 transition-transform ${stationSelectorOpen ? 'rotate-180':''}`}/>
                                </button>
                                {stationSelectorOpen && (
                                    <div className="absolute top-full left-0 mt-2 w-full bg-white rounded-xl shadow-2xl z-50 text-gray-800 overflow-hidden animate-fade-in border border-gray-100">
                                        <div className="bg-gray-50 px-4 py-2 text-[10px] font-bold text-gray-400">ì§€ì  ì„ íƒ</div>
                                        {STATION_IDS.map(id => (
                                            <button key={id} onClick={()=>{handleStationChange(id); setStationSelectorOpen(false);}} className={`w-full text-left px-4 py-3 flex items-center space-x-3 hover:bg-blue-50 ${currentStationId===id ? 'bg-blue-50/50':''}`}>
                                                <div className={`w-2 h-2 rounded-full ${currentStationId===id?'bg-blue-600':'bg-gray-300'}`}></div><span className={`text-sm ${currentStationId===id?'font-bold text-blue-700':'font-medium text-gray-600'}`}>{getStationName(id)}</span>
                                            </button>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>
                    </header>

                    {/* ì•Œë¦¼ ë°°ë„ˆ */}
                    {alerts.length > 0 && <div className="bg-red-50 px-4 py-2 border-b border-red-100">{alerts.map((a,i)=><div key={i} className="flex items-center text-red-600 text-xs font-bold mb-1"><Icon name="alert-triangle" size={14} className="mr-2"/>{a.msg}</div>)}</div>}

                    {/* ë©”ì¸ */}
                    <main className="flex-1 overflow-y-auto pb-24 p-4 space-y-4" onClick={()=>setStationSelectorOpen(false)}>
                        {activeTab === 'dashboard' && (
                            <>
                                <div className="bg-white rounded-2xl shadow-sm p-6 border border-gray-100">
                                    <div className="flex justify-between items-start mb-2">
                                        <div><h3 className="text-gray-500 text-sm font-semibold">{currentStationName} ë§¤ì¶œì´ìµ</h3><div className="flex items-baseline space-x-1 mt-1"><span className="text-4xl font-extrabold text-gray-800">{formatNumber(Math.round(summary.totalProfit))}</span><span className="text-base text-gray-500 font-medium">ì›</span></div></div>
                                        <div className={`p-2 rounded-xl shadow-sm ${summary.totalProfit>=0?'bg-blue-50 text-blue-600':'bg-red-50 text-red-600'}`}><Icon name="trending-up" size={24}/></div>
                                    </div>
                                    <div className="w-full bg-gray-100 h-2 rounded-full mt-5 overflow-hidden"><div className={`h-full rounded-full transition-all duration-1000 ${achievementRate>=100?'bg-gradient-to-r from-yellow-400 to-orange-500':'bg-blue-600'}`} style={{width: `${Math.min(100, achievementRate)}%`}}></div></div>
                                    <div className="flex justify-between mt-2 text-xs text-gray-400 font-medium"><span>ëª©í‘œ {formatNumber(currentGoal)}ì›</span><span className={`${achievementRate>=100?'text-orange-500':'text-blue-600'} font-bold`}>{achievementRate}% ë‹¬ì„±</span></div>
                                </div>
                                <div className="grid grid-cols-1 gap-3">
                                    {['gasoline','diesel','kerosene'].map(type => {
                                        const item = currentInventory[type];
                                        const isLow = item.amount > 0 && item.amount < appSettings.alertThreshold;
                                        return (
                                            <div key={type} className={`bg-white p-4 rounded-xl shadow-sm border flex justify-between items-center relative overflow-hidden ${isLow?'border-red-300':'border-gray-100'}`}>
                                                <div className={`absolute left-0 top-0 bottom-0 w-1.5 ${item.color}`}></div>
                                                <div>
                                                    <div className="flex items-center space-x-2 mb-1.5"><span className={`text-[10px] font-extrabold px-2 py-0.5 rounded-md bg-gray-100 ${item.text}`}>{item.name}</span>{isLow && <span className="text-[10px] text-red-500 font-bold flex items-center"><Icon name="alert-circle" size={10} className="mr-0.5"/>ë¶€ì¡±</span>}</div>
                                                    <div className="flex flex-col"><span className="text-[10px] text-gray-400 font-bold uppercase">Tank Level</span><div className="flex items-baseline space-x-1"><span className="text-xl font-bold text-gray-800">{formatNumber(item.amount)}</span><span className="text-xs text-gray-500">L</span></div></div>
                                                </div>
                                                <div className="text-right"><p className="text-[10px] text-gray-400 font-bold uppercase">Avg Cost</p><p className="text-sm font-bold text-gray-700">@{formatNumber(item.avgPrice)}</p></div>
                                            </div>
                                        )
                                    })}
                                </div>
                            </>
                        )}
                        {activeTab === 'analysis' && (
                            <>
                                <h2 className="text-lg font-bold text-gray-800 flex items-center"><Icon name="trending-up" size={20} className="mr-2 text-blue-600"/> ë¶„ì„</h2>
                                <div className="bg-white p-5 rounded-2xl shadow-sm border border-gray-100"><h3 className="text-sm font-bold text-gray-700">ì¼ë³„ ë§¤ì¶œì´ìµ ì¶”ì´</h3><SimpleLineChart data={summary.chartData} /></div>
                                <div className="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                                    <h3 className="text-sm font-bold text-gray-700 mb-4">ìœ ì¢…ë³„ íŒë§¤ëŸ‰</h3>
                                    <div className="space-y-3">
                                        {['gasoline','diesel','kerosene'].map(type => {
                                            const val = summary.totalSalesVolume[type]; const total = Object.values(summary.totalSalesVolume).reduce((a,b)=>a+b,0)||1; const pct = Math.round((val/total)*100); const item = currentInventory[type];
                                            return (<div key={type}><div className="flex justify-between text-xs mb-1"><span className="font-bold text-gray-600">{item.name}</span><span className="text-gray-400">{pct}% ({formatNumber(val)}L)</span></div><div className="w-full bg-gray-100 h-2 rounded-full overflow-hidden"><div className={`h-full ${item.color} transition-all duration-500`} style={{width:`${pct}%`}}></div></div></div>)
                                        })}
                                    </div>
                                </div>
                            </>
                        )}
                        {activeTab === 'input' && (
                            <div className="bg-white rounded-2xl shadow-lg p-6 border border-gray-100 mb-60">
                                <h2 className="text-lg font-bold text-gray-800 mb-2 flex items-center"><Icon name="plus" size={20} className="mr-2 text-blue-600"/>ì…ë ¥</h2>
                                <p className="text-xs text-gray-400 mb-6 flex items-center"><Icon name="map-pin" size={12} className="mr-1"/> í˜„ì¬ ì§€ì : <span className="text-blue-600 font-bold ml-1">{currentStationName}</span></p>
                                <form onSubmit={handleSubmit} className="space-y-5">
                                    <div className="flex bg-gray-100 p-1.5 rounded-xl">{['sale','purchase'].map(t => (<button key={t} type="button" onClick={()=>setInputType(t)} className={`flex-1 py-3 text-sm font-bold rounded-lg transition-all ${inputType===t ? (t==='sale'?'bg-white text-blue-600 shadow-sm':'bg-white text-green-600 shadow-sm'):'text-gray-400'}`}>{t==='sale'?'ë§¤ì¶œ (íŒë§¤)':'ë§¤ì… (ì…ê³ )'}</button>))}</div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="space-y-1"><label className="text-xs font-bold text-gray-500 ml-1">ë‚ ì§œ</label><input type="date" value={inputDate} onChange={e=>setInputDate(e.target.value)} className="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl text-sm font-bold"/></div>
                                        <div className="space-y-1"><label className="text-xs font-bold text-gray-500 ml-1">ìœ ì¢…</label><select value={inputFuelType} onChange={e=>setInputFuelType(e.target.value)} className="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl text-sm font-bold"><option value="gasoline">íœ˜ë°œìœ </option><option value="diesel">ê²½ìœ </option><option value="kerosene">ë“±ìœ </option></select></div>
                                    </div>
                                    <div className="space-y-1"><label className="text-xs font-bold text-gray-500 ml-1">{inputType==='purchase'?'ì…ê³ ëŸ‰ (L)':'íŒë§¤ëŸ‰ (L)'}</label><input type="number" onFocus={handleFocus} placeholder="0" value={inputAmount} onChange={e=>setInputAmount(e.target.value)} className="w-full p-3 pl-4 bg-gray-50 border border-gray-200 rounded-xl text-lg font-bold"/></div>
                                    <div className="space-y-1"><label className="text-xs font-bold text-gray-500 ml-1">{inputType==='purchase'?'ë§¤ì… ë‹¨ê°€':'íŒë§¤ ë‹¨ê°€'}</label><input type="number" onFocus={handleFocus} placeholder="0" value={inputPrice} onChange={e=>setInputPrice(e.target.value)} className="w-full p-3 pl-4 bg-gray-50 border border-gray-200 rounded-xl text-lg font-bold"/></div>
                                    <button type="submit" className={`w-full py-4 rounded-xl text-white font-bold shadow-lg active:scale-95 transition-all flex items-center justify-center ${inputType==='purchase'?'bg-green-600':'bg-blue-600'}`}><Icon name="save" size={18} className="mr-2"/>ì €ì¥í•˜ê¸°</button>
                                </form>
                            </div>
                        )}
                        {activeTab === 'history' && (
                            <>
                                <div className="flex justify-between items-center mb-4"><h2 className="text-lg font-bold text-gray-800">ìµœê·¼ ê±°ë˜ ë‚´ì—­</h2><button onClick={handleCopyAllTransactions} className="flex items-center space-x-1 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-lg text-xs font-bold hover:bg-blue-100 transition-colors"><Icon name="share-2" size={14} /><span>ì¹´í†¡ ê³µìœ  (ì „ì²´)</span></button></div>
                                <div className="space-y-3">
                                    {stationTransactions.sort((a,b)=>b.id-a.id).map(item => (
                                        <div key={item.id} className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex flex-col">
                                            <div className="flex justify-between items-center mb-2">
                                                <div className="flex items-center space-x-3">
                                                    <div className={`w-10 h-10 rounded-full flex items-center justify-center ${item.type==='purchase'?'bg-green-50 text-green-600':'bg-blue-50 text-blue-600'}`}><Icon name={item.type==='purchase'?'arrow-right':'dollar-sign'} className={item.type==='purchase'?'rotate-90':''} size={18}/></div>
                                                    <div>
                                                        <div className="flex items-center space-x-2">
                                                            <span className="font-bold text-gray-800">{item.type==='purchase'?'ì…ê³ ':'íŒë§¤'} {formatNumber(item.amount)}L</span>
                                                            <span className={`text-[10px] font-bold px-2 py-0.5 rounded border ${getFuelStyle(item.fuelType)}`}>
                                                                {currentInventory[item.fuelType].name}
                                                            </span>
                                                        </div>
                                                        <p className="text-xs text-gray-400 mt-0.5">{item.date}</p>
                                                    </div>
                                                </div>
                                                <div className="text-right"><p className="font-bold text-gray-900">{formatNumber(item.total)}ì›</p><p className="text-xs text-gray-400">@{formatNumber(item.price)}</p></div>
                                            </div>
                                            <div className="flex justify-end space-x-3 mt-2 pt-2 border-t border-gray-50">
                                                <button onClick={() => setEditingTransaction(item)} className="px-3 py-1.5 text-sm font-bold text-black bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors">ìˆ˜ì •</button>
                                                <button onClick={() => requestDelete(item.id)} className="px-3 py-1.5 text-sm font-bold text-black bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors">ì‚­ì œ</button>
                                            </div>
                                        </div>
                                    ))}
                                    {stationTransactions.length===0 && <div className="text-center py-10 text-gray-400"><Icon name="history" size={48} className="mx-auto mb-3 opacity-20"/><p>ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p></div>}
                                </div>
                            </>
                        )}
                        {activeTab === 'settings' && (
                            <div className="space-y-5">
                                <h2 className="text-lg font-bold text-gray-800">ì„¤ì •</h2>
                                <div className={`p-5 rounded-2xl shadow-sm border ${appSettings.safeMode ? 'bg-green-50 border-green-200' : 'bg-white border-gray-100'}`}>
                                    <div className="flex justify-between items-center mb-2">
                                        <div className="flex items-center"><div className={`p-2 rounded-lg mr-3 ${appSettings.safeMode ? 'bg-green-200 text-green-700' : 'bg-gray-100 text-gray-500'}`}><Icon name="lock" size={20}/></div><div><h3 className="font-bold text-gray-800">ë°ì´í„° ë³´í˜¸ ëª¨ë“œ</h3><p className="text-xs text-gray-500">{appSettings.safeMode ? 'ì‚­ì œ ë²„íŠ¼ì„ ë³´í˜¸í•©ë‹ˆë‹¤.' : 'ë°ì´í„° ì‚­ì œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.'}</p></div></div>
                                        <button onClick={()=>setAppSettings({...appSettings, safeMode: !appSettings.safeMode})} className={`w-12 h-6 rounded-full transition-colors relative ${appSettings.safeMode ? 'bg-green-500':'bg-gray-300'}`}><div className={`w-4 h-4 bg-white rounded-full absolute top-1 transition-transform ${appSettings.safeMode ? 'left-7':'left-1'}`}></div></button>
                                    </div>
                                </div>
                                <div className="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                                    <div className="flex items-center mb-3"><Icon name="target" size={18} className="text-purple-600 mr-2"/><h3 className="font-bold text-gray-800">ì›” ëª©í‘œ ê¸ˆì•¡</h3></div>
                                    <input type="number" onFocus={handleFocus} value={currentGoal} onChange={e=>setAppSettings({...appSettings, goals: {...appSettings.goals, [currentStationId]: Number(e.target.value)}})} className="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl font-bold"/>
                                    <div className="text-right mt-2 text-sm text-gray-500 font-medium">({formatNumber(currentGoal)}ì›)</div>
                                </div>
                                <div className="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                                    <div className="flex items-center mb-3"><Icon name="map-pin" size={18} className="text-indigo-600 mr-2"/><h3 className="font-bold text-gray-800">ì§€ì  ì´ë¦„ ê´€ë¦¬</h3></div>
                                    <div className="space-y-2">{STATION_IDS.map(id => (<div key={id} className="flex items-center"><span className="w-8 text-xs font-bold text-gray-400">{id.toUpperCase()}</span><input onFocus={handleFocus} type="text" value={appSettings.stationNames[id]} onChange={e=>setAppSettings({...appSettings, stationNames: {...appSettings.stationNames, [id]: e.target.value}})} className="flex-1 p-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-bold"/></div>))}</div>
                                </div>
                                <div className="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
                                    <div className="flex items-center mb-4"><Icon name="save" size={18} className="text-blue-600 mr-2"/><h3 className="font-bold text-gray-800">ë°ì´í„° ë°±ì—… & ë³µêµ¬</h3></div>
                                    <div className="flex space-x-3"><button onClick={handleBackup} className="flex-1 py-3 border border-blue-200 text-blue-600 rounded-xl font-bold text-sm hover:bg-blue-50">íŒŒì¼ë¡œ ì €ì¥</button><label className="flex-1 py-3 border border-gray-200 text-gray-600 rounded-xl font-bold text-sm hover:bg-gray-50 flex items-center justify-center cursor-pointer">íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°<input type="file" accept=".json" onChange={handleRestore} className="hidden" /></label></div>
                                </div>
                            </div>
                        )}
                    </main>

                    {/* í•˜ë‹¨ íƒ­ */}
                    <nav className="bg-white border-t border-gray-200 flex fixed bottom-0 w-full max-w-md pb-safe z-40 h-16">
                        {[{id:'dashboard',icon:'bar-chart-3',label:'í˜„í™©'},{id:'analysis',icon:'trending-up',label:'ë¶„ì„'},{id:'input',icon:'plus',label:'ì…ë ¥', special:true},{id:'history',icon:'history',label:'ë‚´ì—­'},{id:'settings',icon:'settings',label:'ì„¤ì •'}].map(tab => (
                            tab.special ? <div key={tab.id} className="relative -top-6 flex-1 flex justify-center"><button onClick={()=>setActiveTab(tab.id)} className="w-14 h-14 bg-blue-600 rounded-full text-white shadow-lg shadow-blue-300 flex items-center justify-center active:scale-95 transition-transform font-bold text-sm">ì…ë ¥</button></div> : <button key={tab.id} onClick={()=>setActiveTab(tab.id)} className={`flex-1 flex flex-col items-center justify-center ${activeTab===tab.id?'text-blue-600':'text-gray-400'}`}><Icon name={tab.icon} size={24} className={activeTab===tab.id?'scale-110 transition-transform':''}/><span className="text-[10px] font-bold mt-1">{tab.label}</span></button>
                        ))}
                    </nav>

                    {/* ëª¨ë‹¬ ë“± */}
                    {confirmModal.isOpen && (
                        <div className="absolute inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-6">
                            <div className="bg-white w-full max-w-xs rounded-2xl p-6 shadow-2xl animate-fade-in text-center">
                                <div className="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3"><Icon name="alert-triangle" size={24} className="text-red-500"/></div>
                                <h3 className="font-bold text-lg mb-2">í™•ì¸</h3>
                                <p className="text-sm text-gray-500 mb-4">{confirmModal.message}</p>
                                <div className="flex space-x-2"><button onClick={()=>setConfirmModal({...confirmModal, isOpen: false})} className="flex-1 py-3 bg-gray-100 rounded-xl font-bold">ì·¨ì†Œ</button><button onClick={executeConfirmAction} className="flex-1 py-3 bg-red-500 text-white rounded-xl font-bold">í™•ì¸</button></div>
                            </div>
                        </div>
                    )}
                    {editingTransaction && (
                        <div className="absolute inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4">
                            <div className="bg-white w-full max-w-sm rounded-2xl p-6 shadow-2xl animate-fade-in">
                                <div className="flex justify-between items-center mb-4"><h3 className="text-lg font-bold text-gray-900">ê±°ë˜ ìˆ˜ì •</h3><button onClick={() => setEditingTransaction(null)}><Icon name="x" size={20}/></button></div>
                                <form onSubmit={handleUpdateTransaction} className="space-y-4">
                                    <div className="grid grid-cols-2 gap-3"><div><label className="text-xs text-gray-500 font-bold ml-1">ë‚ ì§œ</label><input type="date" value={editingTransaction.date} onChange={(e) => setEditingTransaction({...editingTransaction, date: e.target.value})} className="w-full p-2 bg-gray-50 rounded-lg border border-gray-200 text-sm font-bold" /></div><div><label className="text-xs text-gray-500 font-bold ml-1">ìˆ˜ëŸ‰ (L)</label><input onFocus={handleFocus} type="number" value={editingTransaction.amount} onChange={(e) => setEditingTransaction({...editingTransaction, amount: e.target.value})} className="w-full p-2 bg-gray-50 rounded-lg border border-gray-200 text-sm font-bold" /></div></div>
                                    <div><label className="text-xs text-gray-500 font-bold ml-1">ë‹¨ê°€ (ì›)</label><input onFocus={handleFocus} type="number" value={editingTransaction.price} onChange={(e) => setEditingTransaction({...editingTransaction, price: e.target.value})} className="w-full p-2 bg-gray-50 rounded-lg border border-gray-200 text-sm font-bold" /></div>
                                    <button type="submit" className="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl flex items-center justify-center"><Icon name="check" size={18} className="mr-2"/> ìˆ˜ì • ì™„ë£Œ</button>
                                </form>
                            </div>
                        </div>
                    )}
                    
                    {/* ìƒì„¸ ë„ì›€ë§ íŒì—… (ê°•í™”ë¨) */}
                    {helpModalOpen && (
                        <div className="absolute inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4">
                            <div className="bg-white w-full max-w-sm rounded-2xl p-6 shadow-2xl animate-fade-in max-h-[85vh] overflow-y-auto">
                                <div className="flex justify-between items-center mb-5 sticky top-0 bg-white z-10 pb-2 border-b border-gray-100">
                                    <div className="flex items-center text-blue-600"><Icon name="book-open" size={22} className="mr-2"/><h3 className="text-xl font-bold">ì‚¬ìš©ì ë§¤ë‰´ì–¼</h3></div>
                                    <button onClick={()=>setHelpModalOpen(false)} className="p-1 bg-gray-100 rounded-full hover:bg-gray-200"><Icon name="x" size={20}/></button>
                                </div>
                                <div className="space-y-6 text-sm text-gray-700">
                                    {/* 1. ì§€ì  ê´€ë¦¬ */}
                                    <div className="bg-slate-50 p-4 rounded-xl border border-slate-100">
                                        <h4 className="font-bold text-indigo-600 mb-2 flex items-center"><Icon name="map-pin" size={16} className="mr-1.5"/>1. ì§€ì  ê´€ë¦¬ (í•„ìˆ˜)</h4>
                                        <p className="text-xs leading-relaxed text-gray-500 mb-2">ìƒë‹¨ì˜ <span className="text-gray-800 font-bold">ì§€ì  ì´ë¦„</span>ì„ ëˆ„ë¥´ë©´ 1í˜¸ì , 2í˜¸ì , 3í˜¸ì ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê±°ë˜ë¥¼ ì…ë ¥í•˜ê¸° ì „ì— ê¼­ ì§€ì ì„ í™•ì¸í•˜ì„¸ìš”!</p>
                                        <p className="text-xs text-gray-400">* ì§€ì  ì´ë¦„ì€ [ì„¤ì •] íƒ­ì—ì„œ ë³€ê²½ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                                    </div>

                                    {/* 2. ê±°ë˜ ì…ë ¥ */}
                                    <div className="bg-slate-50 p-4 rounded-xl border border-slate-100">
                                        <h4 className="font-bold text-blue-600 mb-2 flex items-center"><Icon name="plus-circle" size={16} className="mr-1.5"/>2. ê±°ë˜ ì…ë ¥ (ë§¤ì¼)</h4>
                                        <ul className="text-xs space-y-2 text-gray-500">
                                            <li className="flex items-start"><span className="text-green-600 font-bold mr-1">ë§¤ì…:</span> ìœ ì¡°ì°¨ ì…ê³  ì‹œ ìˆ˜ëŸ‰/ë‹¨ê°€ ì…ë ¥. íƒ±í¬ ì¬ê³ ê°€ ìë™ìœ¼ë¡œ ëŠ˜ì–´ë‚©ë‹ˆë‹¤.</li>
                                            <li className="flex items-start"><span className="text-blue-600 font-bold mr-1">ë§¤ì¶œ:</span> ë§ˆê° ì‹œ íŒë§¤ëŸ‰ ì…ë ¥. (íŒë§¤ê°€ - í‰ê· ì›ê°€)ë¡œ ë§¤ì¶œì´ìµì´ ìë™ ê³„ì‚°ë©ë‹ˆë‹¤.</li>
                                        </ul>
                                    </div>

                                    {/* 3. í˜„í™© ë° ë¶„ì„ */}
                                    <div className="bg-slate-50 p-4 rounded-xl border border-slate-100">
                                        <h4 className="font-bold text-green-600 mb-2 flex items-center"><Icon name="bar-chart-3" size={16} className="mr-1.5"/>3. í˜„í™© ë° ë¶„ì„</h4>
                                        <p className="text-xs leading-relaxed text-gray-500 mb-2"><strong>ëŒ€ì‹œë³´ë“œ:</strong> í˜„ì¬ íƒ±í¬ ì¬ê³ ì™€ ì´ë²ˆ ë‹¬ ë§¤ì¶œì´ìµ ëª©í‘œ ë‹¬ì„±ë¥ ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                                        <p className="text-xs leading-relaxed text-gray-500"><strong>ë¶„ì„ íƒ­:</strong> ìµœê·¼ 7ì¼ê°„ ìˆ˜ìµ ë³€í™”ì™€ ìœ ì¢…ë³„ íŒë§¤ ë¹„ìœ¨ì„ ê·¸ë˜í”„ë¡œ ì œê³µí•©ë‹ˆë‹¤.</p>
                                    </div>

                                    {/* 4. ë‚´ì—­ ë° ë°ì´í„° ë³´í˜¸ */}
                                    <div className="bg-slate-50 p-4 rounded-xl border border-slate-100">
                                        <h4 className="font-bold text-orange-600 mb-2 flex items-center"><Icon name="shield" size={16} className="mr-1.5"/>4. ë°ì´í„° ê´€ë¦¬ (ì¤‘ìš”)</h4>
                                        <ul className="text-xs space-y-2 text-gray-500">
                                            <li><strong className="text-gray-700">ìˆ˜ì •/ì‚­ì œ:</strong> [ë‚´ì—­] íƒ­ì—ì„œ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë‹¨, [ì„¤ì •]ì˜ <span className="text-green-600 font-bold">'ë°ì´í„° ë³´í˜¸ ëª¨ë“œ'</span>ê°€ ì¼œì ¸ ìˆìœ¼ë©´ ì‚­ì œê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
                                            <li><strong className="text-gray-700">ë°±ì—…:</strong> í°ì„ ë°”ê¾¸ê±°ë‚˜ ì•±ì„ ì‚­ì œí•  ë•Œë¥¼ ëŒ€ë¹„í•´ [ì„¤ì •] > [íŒŒì¼ë¡œ ì €ì¥]ì„ ê¼­ í•´ì£¼ì„¸ìš”.</li>
                                        </ul>
                                    </div>
                                </div>
                                <div className="mt-6 pt-2">
                                    <button onClick={()=>setHelpModalOpen(false)} className="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg active:scale-95 transition-all">í™•ì¸í–ˆìŠµë‹ˆë‹¤</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* í† ìŠ¤íŠ¸ */}
                    {toast.show && <div className="absolute bottom-20 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-full text-xs font-bold shadow-lg animate-fade-in flex items-center whitespace-nowrap z-50"><Icon name="check" size={14} className="mr-1.5 text-green-400"/>{toast.message}</div>}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<GasStationProfitApp />);
    </script>
</body>
</html>
